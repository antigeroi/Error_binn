<!DOCTYPE html>
<html>
<head>
    <title>–°–æ–∑–¥–∞—Ç—å –ø–∞—Å—Ç—É</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #111; color: #fff; font-family: Arial; padding: 20px; }
        .header { display: flex; align-items: center; margin-bottom: 30px; }
        .back-btn { color: white; font-size: 30px; margin-right: 15px; text-decoration: none; }
        h1 { color: red; margin: 0; }
        .form-group { margin-bottom: 20px; }
        input, textarea { width: 100%; padding: 15px; background: #222; border: 1px solid #444; color: white; border-radius: 8px; }
        textarea { min-height: 100px; resize: vertical; }
        .btn { width: 100%; padding: 15px; border: none; border-radius: 8px; font-weight: bold; margin-top: 10px; }
        .btn-submit { background: #0f0; color: black; }
        .btn-cancel { background: #333; color: white; }
        .message { background: red; color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; display: none; }
        .message.success { background: #0f0; color: black; }
        .char-count { text-align: right; color: #888; font-size: 12px; margin-top: 5px; }
        .login-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #111; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 10000; }
        .login-box { background: #222; padding: 30px; border-radius: 15px; width: 90%; max-width: 400px; border: 2px solid red; text-align: center; }
        .login-title { color: red; margin-bottom: 20px; }
        .login-input { width: 100%; padding: 15px; background: #333; border: 1px solid #444; border-radius: 8px; color: white; text-align: center; font-size: 18px; margin-bottom: 15px; }
        .login-btn { width: 100%; padding: 15px; background: red; color: white; border: none; border-radius: 8px; font-size: 18px; font-weight: bold; }
        .login-error { color: red; margin-top: 10px; display: none; }
    </style>
</head>
<body>

<!-- –≠–ö–†–ê–ù –í–•–û–î–ê -->
<div id="loginScreen" class="login-screen">
    <div class="login-box">
        <h1 class="login-title">üîí ERRORBIN</h1>
        <input type="password" class="login-input" id="passwordInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞" autocomplete="off">
        <button class="login-btn" onclick="checkPassword()">–í–û–ô–¢–ò</button>
        <div class="login-error" id="loginError">‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!</div>
    </div>
</div>

<!-- –û–°–ù–û–í–ù–û–ô –≠–ö–†–ê–ù -->
<div id="mainContent" style="display: none;">
    <div class="header">
        <a href="index.html" class="back-btn">‚Üê</a>
        <h1>–°–æ–∑–¥–∞—Ç—å –ø–∞—Å—Ç—É</h1>
    </div>

    <div class="message" id="message"></div>

    <div class="form-group">
        <input type="text" id="lika" placeholder="üîë –õ–ò–ö–ê" maxlength="100" autocomplete="off">
        <div class="char-count" id="likaCount">0/100</div>
    </div>

    <div class="form-group">
        <textarea id="validation" placeholder="‚úÖ –í–ê–õ–ò–î–ê–¶–ò–Ø" maxlength="500"></textarea>
        <div class="char-count" id="validationCount">0/500</div>
    </div>

    <div class="form-group">
        <textarea id="content" placeholder="üìÑ –ü–ê–°–¢–ê"></textarea>
        <div class="char-count" id="contentCount">0/2000</div>
    </div>

    <button class="btn btn-submit" onclick="submitPaste()">‚úÖ –û–¢–ü–†–ê–í–ò–¢–¨</button>
    <button class="btn btn-cancel" onclick="window.location='index.html'">‚ùå –û–¢–ú–ï–ù–ê</button>
</div>

<script>
// üõ°Ô∏è –ó–ê–®–ò–§–†–û–í–ê–ù–ù–´–ï –ö–õ–Æ–ß–ò
const ENCRYPTED_DATA = {
    data1: "Nj5lNTc5ZjJhZTU5NmU3MDhmYzEzZjU3",
    data2: "JDJhJDEwJGxNM25IV2Y1b2hFM..",
    data3: "MTIyMzMx",
    salt: "ZHIzQkZOZXh3dDRt"
};

// üîì –î–ï–®–ò–§–†–û–í–ö–ê
function decryptConfig(password) {
    try {
        const part1 = atob(ENCRYPTED_DATA.data1);
        const part2 = atob(ENCRYPTED_DATA.data2.replace('..', 'ohFdWY1K/tn07eVuj7W80ZljxdwJUaND/cBOQdKKxptVC'));
        const part3 = atob(ENCRYPTED_DATA.data3);
        
        const check = password.split('').map(c => c.charCodeAt(0)).reduce((a,b) => a + b, 0);
        if (check !== 1127 && password !== "error2024!") {
            return null;
        }
        
        return {
            BIN_ID: part1,
            MASTER_KEY: part2,
            ADMIN_PASS: part3
        };
    } catch (e) {
        return null;
    }
}

let CONFIG = null;

// üîê –ü–†–û–í–ï–†–ö–ê –ü–ê–†–û–õ–Ø
function checkPassword() {
    const password = document.getElementById('passwordInput').value;
    const validPasswords = ["error2024!", "122331", "errorbin"];
    
    if (validPasswords.includes(password)) {
        CONFIG = decryptConfig(password);
        if (CONFIG) {
            localStorage.setItem('eb_auth', '1');
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            setupCharCounters();
        } else {
            document.getElementById('loginError').style.display = 'block';
        }
    } else {
        document.getElementById('loginError').style.display = 'block';
        document.getElementById('passwordInput').value = '';
    }
}

// üìù –ù–ê–°–¢–†–û–ô–ö–ê –°–ß–ï–¢–ß–ò–ö–û–í
function setupCharCounters() {
    const fields = [
        { id: 'lika', max: 100 },
        { id: 'validation', max: 500 },
        { id: 'content', max: 2000 }
    ];
    
    fields.forEach(field => {
        const input = document.getElementById(field.id);
        const counter = document.getElementById(field.id + 'Count');
        
        input.addEventListener('input', () => {
            const length = input.value.length;
            counter.textContent = `${length}/${field.max}`;
            
            if (length > field.max) {
                input.value = input.value.substring(0, field.max);
                counter.textContent = `${field.max}/${field.max}`;
            }
        });
    });
}

// üì® –û–¢–ü–†–ê–í–ò–¢–¨ –ü–ê–°–¢–£
async function submitPaste() {
    const lika = document.getElementById('lika').value.trim();
    const validation = document.getElementById('validation').value.trim();
    const content = document.getElementById('content').value.trim();
    
    if (!lika || !validation || !content) {
        showMessage('‚ùå –ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!');
        return;
    }
    
    const btn = document.querySelector('.btn-submit');
    const originalText = btn.textContent;
    btn.textContent = 'üîÑ –û—Ç–ø—Ä–∞–≤–∫–∞...';
    btn.disabled = true;
    
    try {
        const response = await fetch(
            `https://api.jsonbin.io/v3/b/${CONFIG.BIN_ID}/latest`,
            { headers: { 'X-Master-Key': CONFIG.MASTER_KEY } }
        );
        
        if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
        const data = await response.json();
        const db = data.record;
        
        db.pastes.push({
            id: Date.now(),
            lika: lika,
            validation: validation,
            content: content,
            author: 'user_' + Math.random().toString(36).substr(2, 8),
            status: 'pending',
            tag: '',
            date: new Date().toLocaleString('ru-RU')
        });
        
        const saveResponse = await fetch(`https://api.jsonbin.io/v3/b/${CONFIG.BIN_ID}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-Master-Key': CONFIG.MASTER_KEY,
                'X-Bin-Versioning': 'false'
            },
            body: JSON.stringify(db)
        });
        
        if (saveResponse.ok) {
            showMessage('‚úÖ –ü–∞—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é!', 'success');
            
            ['lika', 'validation', 'content'].forEach(id => {
                document.getElementById(id).value = '';
                document.getElementById(id + 'Count').textContent = '0/' + 
                    (id === 'lika' ? 100 : id === 'validation' ? 500 : 2000);
            });
            
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 2000);
        } else {
            throw new Error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
        }
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞:', error);
        showMessage('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ');
        btn.textContent = originalText;
        btn.disabled = false;
    }
}

// üí¨ –°–û–û–ë–©–ï–ù–ò–ï
function showMessage(text, type = 'error') {
    const msg = document.getElementById('message');
    msg.textContent = text;
    msg.className = 'message' + (type === 'success' ? ' success' : '');
    msg.style.display = 'block';
    
    if (type === 'success') {
        setTimeout(() => msg.style.display = 'none', 3000);
    }
}

// üöÄ –ê–í–¢–û-–í–•–û–î
window.addEventListener('DOMContentLoaded', () => {
    const auth = localStorage.getItem('eb_auth');
    if (auth) {
        CONFIG = decryptConfig("error2024!");
        if (CONFIG) {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainContent').style.display = 'block';
            setupCharCounters();
        }
    }
});

// ENTER –¥–ª—è –≤—Ö–æ–¥–∞
document.getElementById('passwordInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') checkPassword();
});
</script>
</body>
</html>