<!DOCTYPE html>
<html>
<head>
    <title>–ú–æ–¥–µ—Ä–∞—Ü–∏—è</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #111; color: #fff; font-family: Arial; padding: 20px; }
        .header { display: flex; align-items: center; margin-bottom: 30px; }
        .back-btn { color: white; font-size: 30px; margin-right: 15px; text-decoration: none; }
        h1 { color: red; margin: 0; }
        
        /* –§–û–†–ú–ê –í–•–û–î–ê */
        .login-box { background: #222; padding: 40px; border-radius: 10px; max-width: 400px; margin: 100px auto; text-align: center; border: 2px solid red; }
        .login-input { padding: 15px; width: 100%; margin: 20px 0; background: #333; border: 1px solid #444; color: white; border-radius: 5px; text-align: center; }
        .login-btn { padding: 15px; width: 100%; background: red; color: white; border: none; border-radius: 5px; font-weight: bold; }
        
        /* –ü–ê–°–¢–´ –ù–ê –ú–û–î–ï–†–ê–¶–ò–ò */
        .paste-card { background: #222; padding: 20px; margin: 15px 0; border-radius: 10px; border-left: 4px solid orange; }
        .paste-lika { color: orange; font-weight: bold; }
        .paste-preview { background: #111; padding: 15px; border-radius: 5px; margin: 10px 0; color: #ccc; font-size: 14px; }
        .controls { display: flex; gap: 10px; margin-top: 15px; }
        .control-btn { flex: 1; padding: 10px; border: none; border-radius: 5px; font-weight: bold; }
        .btn-approve { background: #0f0; color: black; }
        .btn-fame { background: purple; color: white; }
        .btn-reject { background: red; color: white; }
        .admin-login { background: #222; padding: 30px; border-radius: 10px; max-width: 400px; margin: 50px auto; text-align: center; border: 2px solid red; }
    </style>
</head>
<body>

<!-- –ü–ï–†–í–´–ô –≠–ö–†–ê–ù - –ü–ê–†–û–õ–¨ –°–ê–ô–¢–ê -->
<div id="siteLogin" class="login-box" style="display: none;">
    <h2 style="margin-bottom: 20px;">üîê ERRORBIN</h2>
    <input type="password" class="login-input" id="sitePassword" placeholder="–ü–∞—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∞–π—Ç—É" autocomplete="off">
    <button class="login-btn" onclick="checkSitePassword()">–î–ê–õ–ï–ï</button>
    <p id="siteError" style="color: red; margin-top: 15px; display: none;">–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!</p>
</div>

<!-- –í–¢–û–†–û–ô –≠–ö–†–ê–ù - –ü–ê–†–û–õ–¨ –ê–î–ú–ò–ù–ê -->
<div id="adminLogin" class="admin-login" style="display: none;">
    <h2 style="margin-bottom: 20px;">üëë –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨</h2>
    <input type="password" class="login-input" id="adminPassword" placeholder="–ü–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∞" autocomplete="off">
    <button class="login-btn" onclick="checkAdminPassword()">–í–û–ô–¢–ò</button>
    <p id="adminError" style="color: red; margin-top: 15px; display: none;">–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∞!</p>
</div>
    
<!-- –ü–ê–ù–ï–õ–¨ –ú–û–î–ï–†–ê–¶–ò–ò -->
<div id="adminPanel" style="display: none;">
    <div class="header">
        <a href="index.html" class="back-btn">‚Üê</a>
        <h1>–ü–∞–Ω–µ–ª—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏</h1>
    </div>
    
    <div id="pendingContainer">
        <div style="text-align: center; padding: 50px; color: #888;">
            –ó–∞–≥—Ä—É–∑–∫–∞...
        </div>
    </div>
</div>

<script>
// üõ°Ô∏è –ó–ê–®–ò–§–†–û–í–ê–ù–ù–´–ï –ö–õ–Æ–ß–ò
const ENCRYPTED_DATA = {
    data1: "Nj5lNTc5ZjJhZTU5NmU3MDhmYzEzZjU3",
    data2: "JDJhJDEwJGxNM25IV2Y1b2hFM..",
    data3: "MTIyMzMx",
    salt: "ZHIzQkZOZXh3dDRt"
};

// üîì –î–ï–®–ò–§–†–û–í–ö–ê
function decryptConfig(password) {
    try {
        const part1 = atob(ENCRYPTED_DATA.data1);
        const part2 = atob(ENCRYPTED_DATA.data2.replace('..', 'ohFdWY1K/tn07eVuj7W80ZljxdwJUaND/cBOQdKKxptVC'));
        const part3 = atob(ENCRYPTED_DATA.data3);
        
        const check = password.split('').map(c => c.charCodeAt(0)).reduce((a,b) => a + b, 0);
        if (check !== 1127 && password !== "error2024!") {
            return null;
        }
        
        return {
            BIN_ID: part1,
            MASTER_KEY: part2,
            ADMIN_PASS: part3
        };
    } catch (e) {
        return null;
    }
}

let CONFIG = null;
let currentVersion = null;

// üîê –ü–†–û–í–ï–†–ö–ê –ü–ê–†–û–õ–Ø –°–ê–ô–¢–ê
function checkSitePassword() {
    const password = document.getElementById('sitePassword').value;
    const validPasswords = ["error2024!", "122331", "errorbin"];
    
    if (validPasswords.includes(password)) {
        CONFIG = decryptConfig(password);
        if (CONFIG) {
            localStorage.setItem('eb_auth', '1');
            document.getElementById('siteLogin').style.display = 'none';
            document.getElementById('adminLogin').style.display = 'block';
        } else {
            document.getElementById('siteError').style.display = 'block';
        }
    } else {
        document.getElementById('siteError').style.display = 'block';
        document.getElementById('sitePassword').value = '';
    }
}

// üîê –ü–†–û–í–ï–†–ö–ê –ü–ê–†–û–õ–Ø –ê–î–ú–ò–ù–ê
function checkAdminPassword() {
    const password = document.getElementById('adminPassword').value;
    
    if (password === CONFIG.ADMIN_PASS) {
        document.getElementById('adminLogin').style.display = 'none';
        document.getElementById('adminPanel').style.display = 'block';
        loadPendingPastes();
    } else {
        document.getElementById('adminError').style.display = 'block';
        document.getElementById('adminPassword').style.borderColor = 'red';
        document.getElementById('adminPassword').value = '';
    }
}

// üì• –ó–ê–ì–†–£–ó–ò–¢–¨ –ü–ê–°–¢–´ –ù–ê –ú–û–î–ï–†–ê–¶–ò–Æ
async function loadPendingPastes() {
    try {
        const response = await fetch(
            `https://api.jsonbin.io/v3/b/${CONFIG.BIN_ID}/latest`,
            { headers: { 'X-Master-Key': CONFIG.MASTER_KEY } }
        );
        
        if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
        const data = await response.json();
        const db = data.record;
        currentVersion = data.metadata.version;
        
        const pending = db.pastes.filter(p => p.status === 'pending');
        
        const container = document.getElementById('pendingContainer');
        if (pending.length === 0) {
            container.innerHTML = '<div style="text-align:center;padding:50px;color:#888">‚úÖ –ù–µ—Ç –ø–∞—Å—Ç –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏</div>';
            return;
        }
        
        container.innerHTML = pending.map(p => `
            <div class="paste-card" id="paste-${p.id}">
                <div class="paste-lika">üîë ${escapeHtml(p.lika)}</div>
                <div style="color:#888;font-size:12px;margin-bottom:10px">
                    üë§ ${escapeHtml(p.author)} ‚Ä¢ üìÖ ${p.date}
                </div>
                
                <div class="paste-preview">
                    <strong>‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è:</strong><br>
                    ${escapeHtml(p.validation.substring(0, 150))}${p.validation.length > 150 ? '...' : ''}
                </div>
                
                <div class="paste-preview">
                    <strong>üìÑ –ü–∞—Å—Ç–∞:</strong><br>
                    ${escapeHtml(p.content.substring(0, 200))}${p.content.length > 200 ? '...' : ''}
                </div>
                
                <div class="controls">
                    <button class="control-btn btn-approve" onclick="approvePaste(${p.id}, false)">
                        ‚úÖ –û–¥–æ–±—Ä–∏—Ç—å
                    </button>
                    <button class="control-btn btn-fame" onclick="approvePaste(${p.id}, true)">
                        üî• #—Ñ–µ–π–º
                    </button>
                    <button class="control-btn btn-reject" onclick="rejectPaste(${p.id})">
                        ‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å
                    </button>
                </div>
            </div>
        `).join('');
        
    } catch (error) {
        document.getElementById('pendingContainer').innerHTML = 
            '<div style="text-align:center;padding:50px;color:red">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
        console.error('Load error:', error);
    }
}

// ‚úÖ –û–î–û–ë–†–ò–¢–¨ –ü–ê–°–¢–£
async function approvePaste(id, addFame) {
    if (!confirm(`–û–¥–æ–±—Ä–∏—Ç—å –ø–∞—Å—Ç—É #${id}${addFame ? ' —Å —Ç–µ–≥–æ–º #—Ñ–µ–π–º' : ''}?`)) return;
    
    try {
        const response = await fetch(
            `https://api.jsonbin.io/v3/b/${CONFIG.BIN_ID}/latest`,
            { headers: { 'X-Master-Key': CONFIG.MASTER_KEY } }
        );
        
        if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
        const data = await response.json();
        const db = data.record;
        
        if (data.metadata.version !== currentVersion) {
            alert('–ë–∞–∑–∞ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å! –û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
            return;
        }
        
        const paste = db.pastes.find(p => p.id === id);
        if (paste) {
            paste.status = 'approved';
            if (addFame) {
                paste.tag = '#—Ñ–µ–π–º';
            }
        }
        
        const saveResponse = await fetch(`https://api.jsonbin.io/v3/b/${CONFIG.BIN_ID}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-Master-Key': CONFIG.MASTER_KEY,
                'X-Bin-Versioning': 'false'
            },
            body: JSON.stringify(db)
        });
        
        if (saveResponse.ok) {
            document.getElementById(`paste-${id}`).remove();
            alert('‚úÖ –ü–∞—Å—Ç–∞ –æ–¥–æ–±—Ä–µ–Ω–∞!');
            currentVersion = (await saveResponse.json()).metadata.version;
        } else {
            throw new Error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
        }
    } catch (error) {
        console.error('Approve error:', error);
        alert('‚ùå –û—à–∏–±–∫–∞!');
    }
}

// ‚ùå –û–¢–ö–õ–û–ù–ò–¢–¨ –ü–ê–°–¢–£
async function rejectPaste(id) {
    if (!confirm(`–û—Ç–∫–ª–æ–Ω–∏—Ç—å –ø–∞—Å—Ç—É #${id}?`)) return;
    
    try {
        const response = await fetch(
            `https://api.jsonbin.io/v3/b/${CONFIG.BIN_ID}/latest`,
            { headers: { 'X-Master-Key': CONFIG.MASTER_KEY } }
        );
        
        if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏');
        const data = await response.json();
        const db = data.record;
        
        if (data.metadata.version !== currentVersion) {
            alert('–ë–∞–∑–∞ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å! –û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
            return;
        }
        
        const paste = db.pastes.find(p => p.id === id);
        if (paste) {
            paste.status = 'rejected';
        }
        
        const saveResponse = await fetch(`https://api.jsonbin.io/v3/b/${CONFIG.BIN_ID}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-Master-Key': CONFIG.MASTER_KEY,
                'X-Bin-Versioning': 'false'
            },
            body: JSON.stringify(db)
        });
        
        if (saveResponse.ok) {
            document.getElementById(`paste-${id}`).remove();
            alert('‚ùå –ü–∞—Å—Ç–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞!');
            currentVersion = (await saveResponse.json()).metadata.version;
        } else {
            throw new Error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
        }
    } catch (error) {
        console.error('Reject error:', error);
        alert('‚ùå –û—à–∏–±–∫–∞!');
    }
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// üöÄ –ê–í–¢–û-–í–•–û–î
window.addEventListener('DOMContentLoaded', () => {
    const auth = localStorage.getItem('eb_auth');
    if (auth) {
        CONFIG = decryptConfig("error2024!");
        if (CONFIG) {
            document.getElementById('siteLogin').style.display = 'none';
            document.getElementById('adminLogin').style.display = 'block';
        }
    } else {
        document.getElementById('siteLogin').style.display = 'block';
    }
});

// ENTER –î–õ–Ø –í–í–û–î–ê
document.getElementById('sitePassword').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') checkSitePassword();
});

document.getElementById('adminPassword').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') checkAdminPassword();
});
</script>
</body>
</html>