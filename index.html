<!DOCTYPE html>
<html>
<head>
    <title>errorbin üîí</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body{background:#111;color:#fff;font-family:'Segoe UI',Arial,sans-serif;margin:0;min-height:100vh}
        .header{background:linear-gradient(135deg,#1a1a1a,#222);padding:15px;border-bottom:2px solid #ff4444;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;z-index:1000;box-shadow:0 2px 10px rgba(255,0,0,0.1)}
        h1{color:#ff4444;margin:0;font-size:20px;font-weight:bold;text-shadow:0 0 10px rgba(255,68,68,0.3)}
        .admin-btn{background:#ff4444;color:white;padding:8px 15px;border-radius:8px;text-decoration:none;font-size:14px;font-weight:bold;transition:all 0.3s;box-shadow:0 2px 5px rgba(255,68,68,0.3)}
        .admin-btn:hover{background:#ff2222;transform:translateY(-1px);box-shadow:0 4px 8px rgba(255,68,68,0.4)}
        .search-box{padding:15px;background:#222;border-bottom:1px solid #333}
        .search-input{width:100%;padding:12px 20px;background:#2a2a2a;border:1px solid #444;border-radius:25px;color:#fff;font-size:14px;transition:all 0.3s}
        .search-input:focus{outline:none;border-color:#ff4444;box-shadow:0 0 10px rgba(255,68,68,0.3)}
        .pastes-container{padding:15px;max-width:800px;margin:0 auto}
        .paste-card{background:linear-gradient(135deg,#2a2a2a,#222);border-radius:12px;padding:15px;margin-bottom:12px;border-left:4px solid #44ff44;cursor:pointer;transition:all 0.3s;box-shadow:0 2px 5px rgba(0,0,0,0.2)}
        .paste-card:hover{background:#2d2d2d;transform:translateY(-2px);box-shadow:0 4px 10px rgba(0,0,0,0.3);border-left-color:#22ff22}
        .paste-lika{color:#44ff44;font-weight:bold;font-size:16px;margin-bottom:5px}
        .paste-author{color:#aaa;font-size:12px;font-family:monospace}
        .fab{position:fixed;bottom:25px;right:25px;width:60px;height:60px;background:linear-gradient(135deg,#fff,#eee);border-radius:30px;display:flex;align-items:center;justify-content:center;color:#ff4444;font-size:28px;font-weight:bold;cursor:pointer;box-shadow:0 4px 15px rgba(255,68,68,0.3);transition:all 0.3s;z-index:999}
        .fab:hover{transform:scale(1.1) rotate(90deg);box-shadow:0 6px 20px rgba(255,68,68,0.5)}
        .no-pastes{text-align:center;padding:50px;color:#888;font-size:16px}
        .paste-tag{background:#ff4444;color:white;padding:3px 10px;border-radius:15px;font-size:11px;margin-left:8px;font-weight:bold}
        
        /* –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û */
        .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:2000;overflow-y:auto;backdrop-filter:blur(5px)}
        .modal-content{background:linear-gradient(135deg,#1a1a1a,#222);margin:40px auto;padding:25px;border-radius:15px;width:95%;max-width:700px;border:1px solid #444;box-shadow:0 10px 30px rgba(0,0,0,0.5)}
        .modal-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;border-bottom:1px solid #444;padding-bottom:15px}
        .modal-title{color:#44ff44;font-size:20px;margin:0;font-weight:bold}
        .close-modal{color:#fff;font-size:30px;cursor:pointer;background:none;border:none;transition:all 0.3s}
        .close-modal:hover{color:#ff4444;transform:scale(1.2)}
        .modal-section{margin-bottom:25px}
        .modal-label{color:#aaa;font-size:14px;margin-bottom:8px;font-weight:bold}
        .modal-text{background:#111;padding:18px;border-radius:10px;white-space:pre-wrap;word-break:break-word;font-family:monospace;color:#fff;border:1px solid #333;max-height:300px;overflow-y:auto}
        .modal-footer{color:#888;font-size:13px;margin-top:25px;border-top:1px solid #444;padding-top:15px;display:flex;justify-content:space-between}
        .copy-btn{background:linear-gradient(135deg,#0088cc,#006699);color:white;border:none;padding:10px 20px;border-radius:8px;cursor:pointer;margin-top:10px;font-weight:bold;transition:all 0.3s;box-shadow:0 2px 5px rgba(0,136,204,0.3)}
        .copy-btn:hover{background:linear-gradient(135deg,#0099dd,#0077aa);transform:translateY(-1px);box-shadow:0 4px 8px rgba(0,136,204,0.4)}
        
        /* –°–ò–°–¢–ï–ú–ù–´–ï –°–û–û–ë–©–ï–ù–ò–Ø */
        .sys-msg{position:fixed;top:20px;right:20px;padding:15px 20px;border-radius:10px;z-index:3000;animation:slideIn 0.3s ease;box-shadow:0 5px 15px rgba(0,0,0,0.3)}
        @keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
        .sys-success{background:linear-gradient(135deg,#44ff44,#22aa22);color:#000}
        .sys-error{background:linear-gradient(135deg,#ff4444,#aa2222);color:#fff}
        .sys-warning{background:linear-gradient(135deg,#ffaa44,#cc8822);color:#000}
        
        /* –ó–ê–©–ò–¢–ù–´–ô –≠–ö–†–ê–ù */
        .shield-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:#111;z-index:9999;display:flex;justify-content:center;align-items:center}
        .shield-box{background:#222;padding:40px;border-radius:15px;text-align:center;border:2px solid #ff4444;max-width:400px;width:90%}
        .shield-input{padding:15px;width:100%;margin:20px 0;background:#333;border:1px solid #444;border-radius:8px;color:#fff;font-size:16px;text-align:center}
        .shield-btn{padding:12px 30px;background:#ff4444;color:white;border:none;border-radius:8px;font-weight:bold;cursor:pointer;transition:all 0.3s}
        .shield-btn:hover{background:#ff2222;transform:scale(1.05)}
    </style>
</head>
<body>
    <!-- –ó–ê–©–ò–¢–ù–´–ô –≠–ö–†–ê–ù -->
    <div class="shield-screen" id="shieldScreen">
        <div class="shield-box">
            <h2 style="color:#ff4444;margin-bottom:10px">üîí ERRORBIN PROTECTION</h2>
            <p style="color:#aaa;margin-bottom:20px">–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–µ</p>
            <input type="password" class="shield-input" id="shieldPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autocomplete="off">
            <button class="shield-btn" onclick="checkShieldPassword()">–í–æ–π—Ç–∏</button>
            <p id="shieldError" style="color:#ff4444;margin-top:15px;display:none">–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!</p>
        </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° -->
    <div class="header">
        <h1>errorbin üîí</h1>
        <a href="moderation.html" class="admin-btn">üõ°Ô∏è –ê–¥–º–∏–Ω</a>
    </div>

    <div class="search-box">
        <input type="text" class="search-input" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –ª–∏–∫–∞–º –∏–ª–∏ #—Ñ–µ–π–º" id="searchInput" autocomplete="off">
    </div>

    <div class="pastes-container" id="pastesContainer">
        <div class="no-pastes">üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π –±–∞–∑—ã...</div>
    </div>

    <div class="fab" onclick="navigateToCreate()">+</div>

    <!-- –ú–û–î–ê–õ–¨–ù–û–ï –û–ö–ù–û -->
    <div class="modal" id="pasteModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle"></div>
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            
            <div class="modal-section">
                <div class="modal-label">üîë –õ–ò–ö–ê:</div>
                <div class="modal-text" id="modalLika"></div>
            </div>
            
            <div class="modal-section">
                <div class="modal-label">‚úÖ –í–ê–õ–ò–î–ê–¶–ò–Ø:</div>
                <div class="modal-text" id="modalValidation"></div>
                <button class="copy-btn" onclick="copyToClipboard('validation')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é</button>
            </div>
            
            <div class="modal-section">
                <div class="modal-label">üìÑ –ü–ê–°–¢–ê:</div>
                <div class="modal-text" id="modalContent"></div>
                <button class="copy-btn" onclick="copyToClipboard('content')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Å—Ç—É</button>
            </div>
            
            <div class="modal-footer">
                <div id="modalAuthor"></div>
                <div id="modalDate"></div>
            </div>
        </div>
    </div>

    <script>
        // üîê –°–ò–°–¢–ï–ú–ê –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–û–ô –ó–ê–©–ò–¢–´
        
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ö–û–ù–°–¢–ê–ù–¢–´ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
        const SECURITY_CONFIG = {
            // –ü–ê–†–û–õ–¨ –î–û–°–¢–£–ü–ê (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤–µ–∑–¥–µ)
            ACCESS_PASSWORD: '188221',
            
            // üîí –ó–ê–®–ò–§–†–û–í–ê–ù–ù–´–ï –ö–õ–Æ–ß–ò (Base64)
            ENCRYPTED_KEYS: {
                binId: 'Njk1ODY5MzlhZTU5NmU3MDhmYzEyNGI3',
                masterKey: 'JDJhJDEwJGwxNWJHczVjSlVpSW1ZRVcwUzhwSnVIUmxrT2hvNTMuZ2FNOGt4NUNOSWFE" + "MHdnWTIyRFo2'
            },
            
            // –°–ò–°–¢–ï–ú–ê –ë–õ–û–ö–ò–†–û–í–ö–ò
            MAX_ATTEMPTS: 3,
            BLOCK_DURATION: 300000, // 5 –º–∏–Ω—É—Ç
            MAX_REQUESTS: 100,
            
            // –î–ò–ù–ê–ú–ò–ß–ï–°–ö–ê–Ø –ó–ê–©–ò–¢–ê
            TOKEN_EXPIRY: 3600000, // 1 —á–∞—Å
            AUTO_REFRESH: 300000, // 5 –º–∏–Ω—É—Ç
        };
        
        // –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
        let securityToken = null;
        let failedAttempts = 0;
        let requestCount = 0;
        let isBlocked = false;
        let sessionStart = null;
        
        // üîê –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ó–ê–©–ò–¢–´
        function initializeSecurity() {
            console.log('üõ°Ô∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã...');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
            const blockedUntil = localStorage.getItem('security_blocked_until');
            if (blockedUntil && Date.now() < parseInt(blockedUntil)) {
                isBlocked = true;
                const remaining = Math.ceil((parseInt(blockedUntil) - Date.now()) / 1000);
                document.getElementById('shieldScreen').innerHTML = `
                    <div class="shield-box">
                        <h2 style="color:#ff4444">üö´ –°–ò–°–¢–ï–ú–ê –ë–õ–û–ö–ò–†–û–í–ê–ù–ê</h2>
                        <p style="color:#aaa">–ü—Ä–µ–≤—ã—à–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫</p>
                        <p style="color:#ffaa44;font-size:24px;margin:20px 0">‚è±Ô∏è ${remaining} —Å–µ–∫</p>
                        <p style="color:#888;font-size:12px">–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è</p>
                    </div>
                `;
                return false;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å–µ—Å—Å–∏–∏
            const sessionData = localStorage.getItem('secure_session');
            if (sessionData) {
                try {
                    const session = JSON.parse(sessionData);
                    if (session.token && session.expiry > Date.now()) {
                        securityToken = session.token;
                        sessionStart = Date.now();
                        document.getElementById('shieldScreen').style.display = 'none';
                        showSysMessage('üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∑–∞—â–∏—â–µ–Ω–Ω–∞—è —Å–µ—Å—Å–∏—è', 'success');
                        initializeApp();
                        return true;
                    }
                } catch(e) {
                    clearSession();
                }
            }
            
            // –ü–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –∑–∞—â–∏—Ç—ã
            document.getElementById('shieldScreen').style.display = 'flex';
            document.getElementById('shieldPassword').focus();
            
            // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ Enter
            document.getElementById('shieldPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') checkShieldPassword();
            });
            
            return false;
        }
        
        // üîê –ü–†–û–í–ï–†–ö–ê –ü–ê–†–û–õ–Ø –ó–ê–©–ò–¢–´
        function checkShieldPassword() {
            const input = document.getElementById('shieldPassword').value.trim();
            const errorElem = document.getElementById('shieldError');
            
            if (input !== SECURITY_CONFIG.ACCESS_PASSWORD) {
                failedAttempts++;
                errorElem.style.display = 'block';
                errorElem.textContent = `–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å! –ü–æ–ø—ã—Ç–∫–∞ ${failedAttempts}/${SECURITY_CONFIG.MAX_ATTEMPTS}`;
                
                if (failedAttempts >= SECURITY_CONFIG.MAX_ATTEMPTS) {
                    blockSystem();
                    return;
                }
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –æ—à–∏–±–∫–∏
                document.getElementById('shieldPassword').style.borderColor = '#ff4444';
                document.getElementById('shieldPassword').style.animation = 'shake 0.5s';
                setTimeout(() => {
                    document.getElementById('shieldPassword').style.animation = '';
                    document.getElementById('shieldPassword').value = '';
                }, 500);
                
                return;
            }
            
            // –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
            failedAttempts = 0;
            createSecureSession();
            document.getElementById('shieldScreen').style.display = 'none';
            showSysMessage('‚úÖ –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω', 'success');
            initializeApp();
        }
        
        // üîê –°–û–ó–î–ê–ù–ò–ï –ó–ê–©–ò–©–ï–ù–ù–û–ô –°–ï–°–°–ò–ò
        function createSecureSession() {
            securityToken = generateToken();
            sessionStart = Date.now();
            
            const sessionData = {
                token: securityToken,
                created: sessionStart,
                expiry: sessionStart + SECURITY_CONFIG.TOKEN_EXPIRY
            };
            
            localStorage.setItem('secure_session', JSON.stringify(sessionData));
            
            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏
            setTimeout(() => {
                showSysMessage('üîÑ –°–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ...', 'warning');
                location.reload();
            }, SECURITY_CONFIG.TOKEN_EXPIRY);
        }
        
        // üîê –ì–ï–ù–ï–†–ê–¶–ò–Ø –¢–û–ö–ï–ù–ê
        function generateToken() {
            const timestamp = Date.now();
            const random = Math.random().toString(36).substring(2);
            const hash = btoa(timestamp + '|' + random + '|' + navigator.userAgent);
            return hash.substring(0, 32);
        }
        
        // üîê –ë–õ–û–ö–ò–†–û–í–ö–ê –°–ò–°–¢–ï–ú–´
        function blockSystem() {
            isBlocked = true;
            const blockUntil = Date.now() + SECURITY_CONFIG.BLOCK_DURATION;
            localStorage.setItem('security_blocked_until', blockUntil.toString());
            localStorage.removeItem('secure_session');
            
            document.getElementById('shieldScreen').innerHTML = `
                <div class="shield-box">
                    <h2 style="color:#ff4444">üö´ –°–ò–°–¢–ï–ú–ê –ë–õ–û–ö–ò–†–û–í–ê–ù–ê</h2>
                    <p style="color:#aaa">–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</p>
                    <div style="margin:20px 0">
                        <div style="width:100%;height:4px;background:#333;border-radius:2px">
                            <div id="blockTimer" style="width:100%;height:100%;background:#ff4444;border-radius:2px;animation:blockTimer 5s linear"></div>
                        </div>
                    </div>
                    <p style="color:#888;font-size:12px">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç</p>
                </div>
            `;
            
            // –ê–≤—Ç–æ—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
            setTimeout(() => {
                localStorage.removeItem('security_blocked_until');
                location.reload();
            }, SECURITY_CONFIG.BLOCK_DURATION);
        }
        
        // üîê –ü–û–ö–ê–ó–ê–¢–¨ –°–ò–°–¢–ï–ú–ù–û–ï –°–û–û–ë–©–ï–ù–ò–ï
        function showSysMessage(text, type = 'info') {
            const msg = document.createElement('div');
            msg.className = `sys-msg sys-${type}`;
            msg.innerHTML = text;
            msg.style.cssText = `
                position:fixed;top:20px;right:20px;
                padding:15px 20px;border-radius:10px;z-index:3000;
                animation:slideIn 0.3s ease;
            `;
            document.body.appendChild(msg);
            
            setTimeout(() => {
                msg.style.animation = 'slideOut 0.3s ease forwards';
                setTimeout(() => msg.remove(), 300);
            }, 3000);
        }
        
        // üîê –ë–ï–ó–û–ü–ê–°–ù–û–ï –î–ï–®–ò–§–†–û–í–ê–ù–ò–ï –ö–õ–Æ–ß–ï–ô
        function getSecureKeys() {
            if (!securityToken) throw new Error('No security token');
            
            try {
                const binId = atob(SECURITY_CONFIG.ENCRYPTED_KEYS.binId);
                const masterKey = atob(SECURITY_CONFIG.ENCRYPTED_KEYS.masterKey);
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–π
                if (!binId || !masterKey || binId.length < 10 || !masterKey.startsWith('$2a$')) {
                    throw new Error('Invalid keys');
                }
                
                return { BIN_ID: binId, MASTER_KEY: masterKey };
            } catch (e) {
                console.error('Key decryption error:', e);
                showSysMessage('‚ö†Ô∏è –û—à–∏–±–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã', 'error');
                return null;
            }
        }
        
        // üîê –ë–ï–ó–û–ü–ê–°–ù–´–ô FETCH
        async function secureFetch(url, options = {}) {
            if (isBlocked) throw new Error('System blocked');
            
            requestCount++;
            if (requestCount > SECURITY_CONFIG.MAX_REQUESTS) {
                showSysMessage('‚ö†Ô∏è –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤', 'warning');
                throw new Error('Request limit exceeded');
            }
            
            if (!options.headers) options.headers = {};
            options.headers['X-Security-Token'] = securityToken;
            options.headers['X-Request-Count'] = requestCount;
            
            // –¢–∞–π–º–∞—É—Ç –¥–ª—è –∑–∞—â–∏—Ç—ã
            const controller = new AbortController();
            const timeoutId = setTimeout(() => controller.abort(), 10000);
            options.signal = controller.signal;
            
            try {
                const response = await fetch(url, options);
                clearTimeout(timeoutId);
                
                if (!response.ok) {
                    if (response.status === 401 || response.status === 403) {
                        showSysMessage('üîê –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è', 'warning');
                        clearSession();
                        location.reload();
                    }
                    throw new Error(`HTTP ${response.status}`);
                }
                
                return response;
            } catch (error) {
                clearTimeout(timeoutId);
                throw error;
            }
        }
        
        // üîê –û–ß–ò–°–¢–ö–ê –°–ï–°–°–ò–ò
        function clearSession() {
            localStorage.removeItem('secure_session');
            securityToken = null;
            sessionStart = null;
        }
        
        // üîê –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        function initializeApp() {
            console.log('üöÄ –ó–∞–ø—É—Å–∫ –∑–∞—â–∏—â–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(checkSecurity, 30000);
            
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
            setInterval(() => {
                if (document.visibilityState === 'visible') {
                    showPastes();
                }
            }, SECURITY_CONFIG.AUTO_REFRESH);
            
            // –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
            setupEventListeners();
            showPastes();
        }
        
        // üîê –ü–†–û–í–ï–†–ö–ê –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò
        function checkSecurity() {
            if (!securityToken || !sessionStart) {
                showSysMessage('‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏', 'warning');
                clearSession();
                location.reload();
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å–µ—Å—Å–∏–∏
            if (Date.now() - sessionStart > SECURITY_CONFIG.TOKEN_EXPIRY - 60000) {
                showSysMessage('üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏...', 'warning');
                createSecureSession();
            }
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
            if (requestCount > SECURITY_CONFIG.MAX_REQUESTS * 0.8) {
                showSysMessage('‚ÑπÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ 80% –ª–∏–º–∏—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤', 'warning');
            }
        }
        
        // üöÄ –û–°–ù–û–í–ù–û–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ
        
        let keys = null;
        let JSONBIN_URL = null;
        
        function setupEventListeners() {
            try {
                keys = getSecureKeys();
                if (!keys) {
                    showSysMessage('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–ª—é—á–µ–π', 'error');
                    return;
                }
                
                JSONBIN_URL = `https://api.jsonbin.io/v3/b/${keys.BIN_ID}`;
                
                // –ü–æ–∏—Å–∫
                document.getElementById('searchInput').addEventListener('input', handleSearch);
                
                // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
                document.addEventListener('visibilitychange', () => {
                    if (document.visibilityState === 'visible') {
                        showPastes();
                    }
                });
                
            } catch (e) {
                console.error('Setup error:', e);
                showSysMessage('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏', 'error');
            }
        }
        
        // –ó–ê–ì–†–£–ó–ò–¢–¨ –ë–ê–ó–£
        async function loadDatabase() {
            try {
                const response = await secureFetch(JSONBIN_URL + '/latest', {
                    headers: { 'X-Master-Key': keys.MASTER_KEY }
                });
                
                const data = await response.json();
                console.log('üìä –ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø–∞—Å—Ç:', data.record.pastes?.length || 0);
                
                // –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
                localStorage.setItem('db_cache', JSON.stringify({
                    data: data.record,
                    timestamp: Date.now()
                }));
                
                return data.record;
            } catch (error) {
                console.warn('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error.message);
                
                // –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∫—ç—à
                try {
                    const cache = localStorage.getItem('db_cache');
                    if (cache) {
                        const cached = JSON.parse(cache);
                        if (Date.now() - cached.timestamp < 300000) { // 5 –º–∏–Ω—É—Ç
                            showSysMessage('üìÅ –ò—Å–ø–æ–ª—å–∑—É–µ–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ', 'warning');
                            return cached.data;
                        }
                    }
                } catch (e) {
                    // ignore
                }
                
                showSysMessage('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–∞–∑—ã', 'error');
                return { pastes: [], users: [] };
            }
        }
        
        // –ü–û–ö–ê–ó–ê–¢–¨ –ü–ê–°–¢–´
        async function showPastes() {
            const container = document.getElementById('pastesContainer');
            
            try {
                const db = await loadDatabase();
                const approved = db.pastes.filter(p => p.status === 'approved');
                
                if (!approved.length) {
                    container.innerHTML = '<div class="no-pastes">üì≠ –ù–µ—Ç –ø–∞—Å—Ç</div>';
                    return;
                }
                
                container.innerHTML = approved.map(p => `
                    <div class="paste-card" onclick="showFullPaste(${p.id})">
                        <div class="paste-lika">
                            üîë ${escapeHtml(p.lika)}
                            ${p.tag ? `<span class="paste-tag">${p.tag}</span>` : ''}
                        </div>
                        <div class="paste-author">üë§ ${escapeHtml(p.author)} ‚Ä¢ üìÖ ${p.date}</div>
                    </div>
                `).join('');
                
            } catch (error) {
                console.error('Show pastes error:', error);
                container.innerHTML = '<div class="no-pastes">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
            }
        }
        
        // –ü–û–ö–ê–ó–ê–¢–¨ –ü–û–õ–ù–£–Æ –ü–ê–°–¢–£
        async function showFullPaste(pasteId) {
            try {
                const db = await loadDatabase();
                const paste = db.pastes.find(p => p.id === pasteId);
                
                if (!paste) {
                    showSysMessage('–ü–∞—Å—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞', 'error');
                    return;
                }
                
                document.getElementById('modalTitle').textContent = `üìÑ –ü–∞—Å—Ç–∞ #${pasteId}`;
                document.getElementById('modalLika').textContent = paste.lika;
                document.getElementById('modalValidation').textContent = paste.validation;
                document.getElementById('modalContent').textContent = paste.content;
                document.getElementById('modalAuthor').textContent = `üë§ –ê–≤—Ç–æ—Ä: ${paste.author}`;
                document.getElementById('modalDate').textContent = `üìÖ ${paste.date}`;
                
                document.getElementById('pasteModal').style.display = 'block';
                document.getElementById('pasteModal').dataset.currentPasteId = pasteId;
                
            } catch (error) {
                showSysMessage('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞—Å—Ç—ã', 'error');
            }
        }
        
        // –ü–û–ò–°–ö
        async function handleSearch(e) {
            const query = e.target.value.toLowerCase();
            if (!query) {
                showPastes();
                return;
            }
            
            try {
                const db = await loadDatabase();
                const approved = db.pastes.filter(p => p.status === 'approved');
                
                let filtered = approved;
                if (query === '#—Ñ–µ–π–º' || query === '—Ñ–µ–π–º') {
                    filtered = approved.filter(p => p.tag === '#—Ñ–µ–π–º');
                } else {
                    filtered = approved.filter(p => 
                        p.lika.toLowerCase().includes(query) ||
                        p.author.toLowerCase().includes(query) ||
                        p.validation.toLowerCase().includes(query) ||
                        p.content.toLowerCase().includes(query)
                    );
                }
                
                const container = document.getElementById('pastesContainer');
                if (!filtered.length) {
                    container.innerHTML = '<div class="no-pastes">üîç –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                    return;
                }
                
                container.innerHTML = filtered.map(p => `
                    <div class="paste-card" onclick="showFullPaste(${p.id})">
                        <div class="paste-lika">${escapeHtml(p.lika)}</div>
                        <div class="paste-author">${escapeHtml(p.author)} ‚Ä¢ ${p.date}</div>
                    </div>
                `).join('');
                
            } catch (error) {
                console.error('Search error:', error);
            }
        }
        
        // –ó–ê–ö–†–´–¢–¨ –ú–û–î–ê–õ–ö–£
        function closeModal() {
            document.getElementById('pasteModal').style.display = 'none';
        }
        
        // –ö–û–ü–ò–†–û–í–ê–¢–¨
        async function copyToClipboard(type) {
            const pasteId = document.getElementById('pasteModal').dataset.currentPasteId;
            if (!pasteId) return;
            
            try {
                const db = await loadDatabase();
                const paste = db.pastes.find(p => p.id === parseInt(pasteId));
                if (!paste) return;
                
                const text = type === 'validation' ? paste.validation : paste.content;
                
                await navigator.clipboard.writeText(text);
                showSysMessage('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä', 'success');
            } catch (err) {
                // Fallback
                const textArea = document.createElement('textarea');
                textArea.value = type === 'validation' ? document.getElementById('modalValidation').textContent : 
                                              document.getElementById('modalContent').textContent;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                showSysMessage('‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ', 'success');
            }
        }
        
        // –ü–ï–†–ï–•–û–î –ö –°–û–ó–î–ê–ù–ò–Æ
        function navigateToCreate() {
            if (!securityToken) {
                showSysMessage('üîê –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è', 'warning');
                return;
            }
            
            // –ü–µ—Ä–µ–¥–∞–µ–º —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ localStorage
            localStorage.setItem('create_token', securityToken);
            window.location.href = 'create.html';
        }
        
        // ESCAPE HTML
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // –ó–ê–ö–†–´–¢–ò–ï –ü–û ESC –ò –ö–õ–ò–ö–£ –í–ù–ï
        window.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });
        
        window.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) closeModal();
        });
        
        // –°–¢–ò–õ–ò –î–õ–Ø –ê–ù–ò–ú–ê–¶–ò–ô
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
            @keyframes blockTimer {
                from { width: 100%; }
                to { width: 0%; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
        
        // –ó–ê–ü–£–°–ö –°–ò–°–¢–ï–ú–´
        initializeSecurity();
        
    </script>
</body>
</html>