<!DOCTYPE html>
<html>
<head>
    <title>errorbin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body{background:#1a1a1a;color:white;font-family:Arial;margin:0}
        .header{background:#2a2a2a;padding:15px;border-bottom:2px solid red;display:flex;justify-content:space-between;align-items:center}
        h1{color:red;margin:0;font-size:18px}
        .admin-btn{background:red;color:white;padding:5px 10px;border-radius:5px;text-decoration:none;font-size:12px}
        .search-box{padding:15px;background:#2a2a2a}
        .search-input{width:100%;padding:10px;background:#3a3a3a;border:1px solid #4a4a4a;border-radius:20px;color:white}
        .pastes-container{padding:15px}
        .paste-card{background:#2a2a2a;border-radius:8px;padding:12px;margin-bottom:10px;border-left:3px solid #0f0}
        .paste-lika{color:#0f0;font-weight:bold}
        .paste-author{color:#888;font-size:12px}
        .fab{position:fixed;bottom:20px;right:20px;width:50px;height:50px;background:white;border-radius:25px;display:flex;align-items:center;justify-content:center;color:red;font-size:24px}
    </style>
</head>
<body>
    <div class="header">
        <h1>errorbin</h1>
        <a href="moderation.html" class="admin-btn">Админ</a>
    </div>

    <div class="search-box">
        <input type="text" class="search-input" placeholder="Поиск по ликам" id="searchInput">
    </div>

    <div class="pastes-container" id="pastesContainer">
        <!-- Пасты здесь -->
    </div>

    <div class="fab" onclick="window.location='create.html'">+</div>

    <script>
        // БАЗА ДАННЫХ ДЛЯ ВСЕХ
        const DB_KEY = 'errorbin_all_users';
        
        // ЗАГРУЗИТЬ ПАСТЫ
        function loadPastes() {
            const db = JSON.parse(localStorage.getItem(DB_KEY) || '{"pastes":[]}');
            const approved = db.pastes.filter(p => p.status === 'approved');
            
            const container = document.getElementById('pastesContainer');
            if(!approved.length) {
                container.innerHTML = '<div style="text-align:center;padding:50px;color:#888">Нет паст</div>';
                return;
            }
            
            container.innerHTML = approved.map(p => `
                <div class="paste-card">
                    <div class="paste-lika">${escapeHtml(p.lika)}</div>
                    <div class="paste-author">by ${escapeHtml(p.author)}</div>
                </div>
            `).join('');
        }
        
        // ПОИСК
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const db = JSON.parse(localStorage.getItem(DB_KEY) || '{"pastes":[]}');
            const approved = db.pastes.filter(p => p.status === 'approved');
            const query = e.target.value.toLowerCase();
            
            const filtered = approved.filter(p => 
                p.lika.toLowerCase().includes(query) ||
                p.author.toLowerCase().includes(query)
            );
            
            const container = document.getElementById('pastesContainer');
            container.innerHTML = filtered.map(p => `
                <div class="paste-card">
                    <div class="paste-lika">${escapeHtml(p.lika)}</div>
                    <div class="paste-author">by ${escapeHtml(p.author)}</div>
                </div>
            `).join('');
        });
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        loadPastes();
    </script>
</body>
</html>